<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="vcovCR returns a sandwich estimate of the variance-covariance matrix
of a set of regression coefficient estimates from a plm
object."><title>Cluster-robust variance-covariance matrix for a plm object. — vcovCR.plm • clubSandwich</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cluster-robust variance-covariance matrix for a plm object. — vcovCR.plm"><meta property="og:description" content="vcovCR returns a sandwich estimate of the variance-covariance matrix
of a set of regression coefficient estimates from a plm
object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">clubSandwich</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.8.9999</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Wald-tests-in-clubSandwich.html">Wald tests of multiple-constraint null hypotheses</a>
    <a class="dropdown-item" href="../articles/meta-analysis-with-CRVE.html">Meta-analysis with cluster-robust variance estimation</a>
    <a class="dropdown-item" href="../articles/panel-data-CRVE.html">Cluster-robust standard errors and hypothesis tests in panel data models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jepusto/clubSandwich/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Cluster-robust variance-covariance matrix for a plm object.</h1>
      <small class="dont-index">Source: <a href="https://github.com/jepusto/clubSandwich/blob/HEAD/R/plm.R" class="external-link"><code>R/plm.R</code></a></small>
      <div class="d-none name"><code>vcovCR.plm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>vcovCR</code> returns a sandwich estimate of the variance-covariance matrix
of a set of regression coefficient estimates from a <code><a href="https://rdrr.io/pkg/plm/man/plm.html" class="external-link">plm</a></code>
object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for plm</span></span>
<span><span class="fu"><a href="vcovCR.html">vcovCR</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">cluster</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">inverse_var</span>,</span>
<span>  form <span class="op">=</span> <span class="st">"sandwich"</span>,</span>
<span>  ignore_FE <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>obj</dt>
<dd><p>Fitted model for which to calculate the variance-covariance matrix</p></dd>


<dt>cluster</dt>
<dd><p>Optional character string, expression, or vector indicating
which observations belong to the same cluster. For fixed-effect models that
include individual effects or time effects (but not both), the cluster will
be taken equal to the included fixed effects if not otherwise specified.
Clustering on individuals can also be obtained by specifying the name of
the individual index (e.g., <code>cluster = "state"</code>) or <code>cluster =
"individual"</code>; clustering on time periods can be obtained by specifying the
name of the time index (e.g., <code>cluster = "year"</code>) or <code>cluster =
"time"</code>; if a group index is specified, clustering on groups (in which
individuals are nested) can be obtained by specifying the name of the group
index or <code>cluster = "group"</code>. For random-effects models, the cluster
will be taken equal to the included random effect identifier if not
otherwise specified.</p></dd>


<dt>type</dt>
<dd><p>Character string specifying which small-sample adjustment should 
be used, with available options <code>"CR0"</code>, <code>"CR1"</code>, <code>"CR1p"</code>,
<code>"CR1S"</code>, <code>"CR2"</code>, or <code>"CR3"</code>. See "Details" section of 
<code><a href="vcovCR.html">vcovCR</a></code> for further information.</p></dd>


<dt>target</dt>
<dd><p>Optional matrix or vector describing the working
variance-covariance model used to calculate the <code>CR2</code> and <code>CR4</code>
adjustment matrices. By default, the target is taken to be an identity
matrix for fixed effect models or the estimated compound-symmetric
covariance matrix for random effects models.</p></dd>


<dt>inverse_var</dt>
<dd><p>Optional logical indicating whether the weights used in 
fitting the model are inverse-variance. If not specified, <code>vcovCR</code> 
will attempt to infer a value.</p></dd>


<dt>form</dt>
<dd><p>Controls the form of the returned matrix. The default 
<code>"sandwich"</code> will return the sandwich variance-covariance matrix. 
Alternately, setting <code>form = "meat"</code> will return only the meat of the 
sandwich and setting <code>form = B</code>, where <code>B</code> is a matrix of 
appropriate dimension, will return the sandwich variance-covariance matrix 
calculated using <code>B</code> as the bread. <code>form = "estfun"</code> will return the 
(appropriately scaled) estimating function, the transposed crossproduct of 
which is equal to the sandwich variance-covariance matrix.</p></dd>


<dt>ignore_FE</dt>
<dd><p>Optional logical controlling whether fixed effects are
ignored when calculating small-sample adjustments in models where fixed
effects are estimated through absorption.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments available for some classes of objects.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>c("vcovCR","clubSandwich")</code>, which consists
  of a matrix of the estimated variance of and covariances between the
  regression coefficient estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="vcovCR.html">vcovCR</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"plm"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/source.html" class="external-link">withAutoprint</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=plm" class="external-link">plm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># fixed effects</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Produc"</span>, package <span class="op">=</span> <span class="st">"plm"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">plm_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html" class="external-link">plm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">gsp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pcap</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">+</span> <span class="va">unemp</span>,</span></span>
<span class="r-in"><span>                data <span class="op">=</span> <span class="va">Produc</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>,<span class="st">"year"</span>,<span class="st">"region"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                effect <span class="op">=</span> <span class="st">"individual"</span>, model <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="vcovCR.html">vcovCR</a></span><span class="op">(</span><span class="va">plm_FE</span>, type<span class="op">=</span><span class="st">"CR2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="vcovCR.html">vcovCR</a></span><span class="op">(</span><span class="va">plm_FE</span>, type <span class="op">=</span> <span class="st">"CR2"</span>, cluster <span class="op">=</span> <span class="va">Produc</span><span class="op">$</span><span class="va">region</span><span class="op">)</span> <span class="co"># clustering on region</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># random effects</span></span></span>
<span class="r-in"><span>  <span class="va">plm_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">plm_FE</span>, model <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="vcovCR.html">vcovCR</a></span><span class="op">(</span><span class="va">plm_RE</span>, type <span class="op">=</span> <span class="st">"CR2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="vcovCR.html">vcovCR</a></span><span class="op">(</span><span class="va">plm_RE</span>, type <span class="op">=</span> <span class="st">"CR2"</span>, cluster <span class="op">=</span> <span class="va">Produc</span><span class="op">$</span><span class="va">region</span><span class="op">)</span> <span class="co"># clustering on region</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># nested random effects</span></span></span>
<span class="r-in"><span>  <span class="va">plm_nested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">plm_FE</span>, effect <span class="op">=</span> <span class="st">"nested"</span>, model <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="vcovCR.html">vcovCR</a></span><span class="op">(</span><span class="va">plm_nested</span>, type <span class="op">=</span> <span class="st">"CR2"</span><span class="op">)</span> <span class="co"># clustering on region</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; library(plm)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; data("Produc", package = "plm")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plm_FE &lt;- plm(log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp, data = Produc, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +     index = c("state", "year", "region"), effect = "individual", model = "within")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; vcovCR(plm_FE, type = "CR2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               log(pcap)       log(pc)      log(emp)         unemp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pcap)  3.900840e-03 -7.382313e-04 -0.0024837779 -7.825846e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pc)   -7.382313e-04  4.177767e-03 -0.0040101610 -9.960967e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(emp)  -2.483778e-03 -4.010161e-03  0.0073152051  1.736024e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp     -7.825846e-05 -9.960967e-05  0.0001736024  6.745842e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; vcovCR(plm_FE, type = "CR2", cluster = Produc$region)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               log(pcap)       log(pc)      log(emp)         unemp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pcap)  6.973505e-03 -0.0022279395 -0.0044833594 -6.786254e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pc)   -2.227940e-03  0.0054359010 -0.0043767642 -1.297104e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(emp)  -4.483359e-03 -0.0043767642  0.0108260634  2.011267e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp     -6.786254e-05 -0.0001297104  0.0002011267  1.170089e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plm_RE &lt;- update(plm_FE, model = "random")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; vcovCR(plm_RE, type = "CR2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               (Intercept)     log(pcap)       log(pc)      log(emp)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.0608153880 -8.772256e-03 -7.015754e-03  0.0136354448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pcap)   -0.0087722560  3.221991e-03  3.731861e-05 -0.0031502393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pc)     -0.0070157539  3.731861e-05  2.060851e-03 -0.0020993882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(emp)     0.0136354448 -3.150239e-03 -2.099388e-03  0.0054047466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp        0.0004200323 -7.947309e-05 -6.416279e-05  0.0001390737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     unemp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  4.200323e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pcap)   -7.947309e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pc)     -6.416279e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(emp)     1.390737e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp        5.848168e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; vcovCR(plm_RE, type = "CR2", cluster = Produc$region)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               (Intercept)     log(pcap)       log(pc)      log(emp)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.0565942863 -0.0138696773 -0.0056768267  0.0190768009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pcap)   -0.0138696773  0.0065345184 -0.0003786724 -0.0063601303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pc)     -0.0056768267 -0.0003786724  0.0024373929 -0.0022193705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(emp)     0.0190768009 -0.0063601303 -0.0022193705  0.0091711531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp        0.0004716871 -0.0000926249 -0.0000839537  0.0001715663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     unemp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  4.716871e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pcap)   -9.262490e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pc)     -8.395370e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(emp)     1.715663e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp        1.057574e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plm_nested &lt;- update(plm_FE, effect = "nested", model = "random")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; vcovCR(plm_nested, type = "CR2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               (Intercept)     log(pcap)       log(pc)      log(emp)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.0537315947 -1.210951e-02 -0.0073309652  0.0193853190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pcap)   -0.0121095110  6.078432e-03 -0.0003141431 -0.0060636185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pc)     -0.0073309652 -3.141431e-04  0.0027593587 -0.0025387198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(emp)     0.0193853190 -6.063618e-03 -0.0025387198  0.0091748282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp        0.0005354663 -9.267671e-05 -0.0001000830  0.0001852566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     unemp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  5.354663e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pcap)   -9.267671e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(pc)     -1.000830e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(emp)     1.852566e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp        1.135799e-05</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pkgs_available</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"plm"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"AER"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">pkgs_available</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/source.html" class="external-link">withAutoprint</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># first differencing</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Fatalities</span>, package <span class="op">=</span> <span class="st">"AER"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">Fatalities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">Fatalities</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">frate</span> <span class="op">&lt;-</span> <span class="fl">10000</span> <span class="op">*</span> <span class="va">fatal</span> <span class="op">/</span> <span class="va">pop</span></span></span>
<span class="r-in"><span>    <span class="va">drinkagec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">drinkage</span>, breaks <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">22</span>, include.lowest <span class="op">=</span> <span class="cn">TRUE</span>, right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">drinkagec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></span><span class="op">(</span><span class="va">drinkagec</span>, ref <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">plm_FD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html" class="external-link">plm</a></span><span class="op">(</span><span class="va">frate</span> <span class="op">~</span> <span class="va">beertax</span> <span class="op">+</span> <span class="va">drinkagec</span> <span class="op">+</span> <span class="va">miles</span> <span class="op">+</span> <span class="va">unemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                data <span class="op">=</span> <span class="va">Fatalities</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>, <span class="st">"year"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                model <span class="op">=</span> <span class="st">"fd"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html" class="external-link">vcovHC</a></span><span class="op">(</span><span class="va">plm_FD</span>, method<span class="op">=</span><span class="st">"arellano"</span>, type <span class="op">=</span> <span class="st">"sss"</span>, cluster <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="vcovCR.html">vcovCR</a></span><span class="op">(</span><span class="va">plm_FD</span>, type <span class="op">=</span> <span class="st">"CR1S"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="vcovCR.html">vcovCR</a></span><span class="op">(</span><span class="va">plm_FD</span>, type <span class="op">=</span> <span class="st">"CR2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; data(Fatalities, package = "AER")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; Fatalities &lt;- within(Fatalities, {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +     frate &lt;- 10000 * fatal/pop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +     drinkagec &lt;- cut(drinkage, breaks = 18:22, include.lowest = TRUE, right = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +     drinkagec &lt;- relevel(drinkagec, ref = 4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plm_FD &lt;- plm(frate ~ beertax + drinkagec + miles + unemp + log(income), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +     data = Fatalities, index = c("state", "year"), model = "fd")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; vcovHC(plm_FD, method = "arellano", type = "sss", cluster = "group")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    (Intercept)       beertax drinkagec[18,19) drinkagec[19,20)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)       4.491252e-04  1.312107e-03     3.177175e-05    -3.224139e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beertax           1.312107e-03  6.112682e-02    -1.374164e-03    -2.155192e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[18,19)  3.177175e-05 -1.374164e-03     5.978249e-03     2.531421e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[19,20) -3.224139e-05 -2.155192e-03     2.531421e-03     2.130959e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[20,21) -2.531288e-04 -9.279081e-04     1.738413e-03     1.185214e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> miles             4.688676e-09 -1.642830e-07    -8.440044e-08    -5.492005e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp            -7.197958e-05 -3.079273e-04    -4.794408e-05    -3.200981e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(income)      -1.853129e-02 -2.489411e-02     3.443431e-03     4.787025e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  drinkagec[20,21)         miles         unemp   log(income)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)         -2.531288e-04  4.688676e-09 -7.197958e-05 -1.853129e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beertax             -9.279081e-04 -1.642830e-07 -3.079273e-04 -2.489411e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[18,19)     1.738413e-03 -8.440044e-08 -4.794408e-05  3.443431e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[19,20)     1.185214e-03 -5.492005e-08 -3.200981e-05  4.787025e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[20,21)     2.529571e-03 -9.131630e-08  1.900456e-04  1.890722e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> miles               -9.131630e-08  1.570809e-11  1.928974e-09 -6.148657e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp                1.900456e-04  1.928974e-09  1.970444e-04  8.234312e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(income)          1.890722e-02 -6.148657e-07  8.234312e-03  1.034150e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"cluster")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "group"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; vcovCR(plm_FD, type = "CR1S")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    (Intercept)       beertax drinkagec[18,19) drinkagec[19,20)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)       4.491252e-04  1.312107e-03     3.177175e-05    -3.224139e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beertax           1.312107e-03  6.112682e-02    -1.374164e-03    -2.155192e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[18,19)  3.177175e-05 -1.374164e-03     5.978249e-03     2.531421e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[19,20) -3.224139e-05 -2.155192e-03     2.531421e-03     2.130959e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[20,21) -2.531288e-04 -9.279081e-04     1.738413e-03     1.185214e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> miles             4.688676e-09 -1.642830e-07    -8.440044e-08    -5.492005e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp            -7.197958e-05 -3.079273e-04    -4.794408e-05    -3.200981e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(income)      -1.853129e-02 -2.489411e-02     3.443431e-03     4.787025e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  drinkagec[20,21)         miles         unemp   log(income)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)         -2.531288e-04  4.688676e-09 -7.197958e-05 -1.853129e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beertax             -9.279081e-04 -1.642830e-07 -3.079273e-04 -2.489411e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[18,19)     1.738413e-03 -8.440044e-08 -4.794408e-05  3.443431e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[19,20)     1.185214e-03 -5.492005e-08 -3.200981e-05  4.787025e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[20,21)     2.529571e-03 -9.131630e-08  1.900456e-04  1.890722e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> miles               -9.131630e-08  1.570809e-11  1.928974e-09 -6.148657e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp                1.900456e-04  1.928974e-09  1.970444e-04  8.234312e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(income)          1.890722e-02 -6.148657e-07  8.234312e-03  1.034150e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; vcovCR(plm_FD, type = "CR2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    (Intercept)       beertax drinkagec[18,19) drinkagec[19,20)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)       4.926777e-04  0.0014903060     5.194011e-05    -1.917433e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beertax           1.490306e-03  0.0639227438    -1.545309e-03    -2.356755e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[18,19)  5.194011e-05 -0.0015453091     6.783986e-03     2.627033e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[19,20) -1.917433e-05 -0.0023567548     2.627033e-03     2.182684e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[20,21) -2.585076e-04 -0.0011673141     1.811511e-03     1.193471e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> miles            -1.036421e-07 -0.0000011056    -1.901583e-07    -1.298187e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp            -7.270549e-05 -0.0002748930    -3.606990e-05    -3.739358e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(income)      -1.903417e-02 -0.0209995682     3.953875e-03     4.817831e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  drinkagec[20,21)         miles         unemp   log(income)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)         -2.585076e-04 -1.036421e-07 -7.270549e-05 -1.903417e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beertax             -1.167314e-03 -1.105600e-06 -2.748930e-04 -2.099957e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[18,19)     1.811511e-03 -1.901583e-07 -3.606990e-05  3.953875e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[19,20)     1.193471e-03 -1.298187e-07 -3.739358e-05  4.817831e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drinkagec[20,21)     2.626823e-03 -1.514746e-07  1.955850e-04  1.969001e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> miles               -1.514746e-07  4.431806e-10 -5.460872e-10 -1.329604e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unemp                1.955850e-04 -5.460872e-10  2.005515e-04  8.377011e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(income)          1.969001e-02 -1.329604e-06  8.377011e-03  1.065829e+00</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James Pustejovsky.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

